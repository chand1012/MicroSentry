<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <title>Turret</title>
    </head>
    <script type="text/javascript">
        //needs rewritten for sentryWaitXTrig
        var xstate = 0;
        var trig = 0;
        var sendstring = "";
        var lasttime = 0;
        function doWork(trigstring, event){
            console.log(trigstring);
            $.post("/postrequest", {"byte":trigstring});
            if (event!=="undefined") {
                event.preventDefault();
            }
        }
        function genSend(){
            return xstate.toString() + trig.toString();
        }
       
        // the part after && can be simplified
        window.addEventListener('keydown', function(event){
            if (event.keyCode == 37 ) { // left
                xstate = 1;
            } else if (event.keyCode == 39 ) { // right
                xstate = 2;
            } else if (event.keyCode == 32){
                trig = 1;
            }
            sendstring = genSend();
            doWork(sendstring, event);
        });
        window.addEventListener('keyup', function(event){
            if (event.keyCode == 37 || event.keyCode == 39) { 
                xstate = 0;
            } 
            if (event.keyCode == 32){
                trig = 0;
            }
            sendstring = genSend();
            doWork(sendstring, event);
        });
        console.log("Script Loaded.");
    </script>
    
</html>